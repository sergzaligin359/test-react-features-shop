import React, { Component } from 'react'
import { connect } from 'react-redux';
import { fetchPhones } from 'redux/actions';
import { getPhones } from 'selectors';
import { Link } from 'react-router-dom';
import log from 'hoc/Logger';

import { take } from 'utils';

class Phones extends Component {

    componentDidMount(){
        this.props.fetchPhones();
    };

    phoneHTML(phone){
        const {
            id,
            name,
            image,
            description,
            price
        } = phone;

        const shordDesc = take(description, 20);

        return(
            <div className="col-sm-4 col-lg-4 col-md-4 book-list" key={id}>
                <div className="thumbnail">
                    <img 
                        className="img-thumbnail"
                        src={image}
                        alt={name}
                    />
                    <div className="caption">
                        <h4 className="pull-right">${price}</h4>
                        <h4>
                            <Link to={`/phone/${id}`}>{name}</Link>
                        </h4>
                        <p>{shordDesc}</p>
                        <p className="item-button">
                            <button className="btn btn-primary">Buy now</button>
                            <Link className="btn btn-default" to={`/phone/${id}`}>More info</Link>
                        </p>
                    </div>
                </div>
            </div>
        )
    }

    render(){
        console.log('msg', this.props);
        const { phones } = this.props;
        return (
            <div className="books row">
                { phones.map((phone) => this.phoneHTML(phone)) }
            </div>
        )
    }

}

const mapStateToProps = (state) => ({
    phones: getPhones(state)
});

const mapDispatchToProps = {
    fetchPhones,
};

export default connect(mapStateToProps, mapDispatchToProps)(Phones);